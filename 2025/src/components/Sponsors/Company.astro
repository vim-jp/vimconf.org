---
import type { ImageMetadata } from "astro";

// import.meta.globで画像をlazyロード
const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/sponsors/*.{png,svg}",
);

type Props = {
  sponsor: {
    rank: "platinum" | "gold" | "silver" | "bronze";
    name: string;
    url: string;
    image: string;
  };
};

const props = Astro.props;
const { rank, name, url, image } = props.sponsor;

const imagePath = `/src/assets/sponsors/${image}`;
let imageUrl = "";

if (images[imagePath]) {
  const imageModule = await images[imagePath]();
  imageUrl = imageModule.default.src;
} else {
  console.error(`Image not found: ${imagePath}`);
}

// ランクごとのスタイル設定
const rankStyles = {
  platinum: {
    container:
      "h-72 mb-4 flex items-center justify-center bg-white p-6 rounded-lg border border-gray-100",
    image: "w-full h-full object-contain",
  },
  gold: {
    container:
      "h-52 mb-3 flex items-center justify-center bg-white p-6 rounded-lg border border-gray-100",
    image: "w-full h-full object-contain",
  },
  silver: {
    container:
      "h-32 mb-2 flex items-center justify-center bg-white p-6 rounded-lg border border-gray-100",
    image: "w-full h-full object-contain",
  },
  bronze: {
    container:
      "h-22 mb-2 flex items-center justify-center bg-white p-6 rounded-lg border border-gray-100",
    image: "w-full h-full object-contain",
  },
};

const currentStyle = rankStyles[rank];
---

<a
  href={url}
  class="relative block w-full"
  target="_blank"
  rel="noopener noreferrer"
>
  <div class={currentStyle.container}>
    <img
      alt={name}
      src={imageUrl}
      class={currentStyle.image + " bg-white"}
      loading="lazy"
    />
  </div>
</a>
